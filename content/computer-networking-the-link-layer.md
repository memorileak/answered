+++
title = "Computer Networking: The Link Layer"
date = "2025-04-15"
description = "A comprehensive guide to the link layer in computer networks, covering MAC addresses, Ethernet, error detection, multiple access protocols, switches, VLANs, and more."

[taxonomies]
tags = ["networking", "linklayer"]
+++

## Computer Networking: The Link Layer and LANs

Chapter 6 of "Computer Networking: A Top\-Down Approach" delves into the crucial aspects of the link layer and Local Area Networks \(LANs\)\, providing the mechanisms for data transfer between adjacent network nodes\. This chapter is pivotal in understanding how network\-layer datagrams are actually transmitted across physical links\. Here are the important aspects to remember from this chapter\, elaborated in detail:

**1\. Introduction to the Link Layer and its Role:**

The link layer resides below the network layer in the protocol stack and is responsible for moving datagrams across individual links in the network path from source to destination\. A **node** in the context of the link layer is any device that runs a link\-layer protocol\, including hosts\, routers\, switches\, and WiFi access points\. The communication channels connecting adjacent nodes are referred to as **links**\. For a network\-layer datagram to traverse the entire path\, it must undergo several **link\-layer hops**\, being encapsulated in a **link\-layer frame** for transmission over each link\. The analogy of a tourist's journey with different transportation segments managed by different companies highlights how the link layer provides localized\, direct transportation between adjacent network elements\, similar to a limousine service between two points\.

**2\. Services Provided by the Link Layer:**

The link layer offers various services\, the specifics of which can differ between link\-layer protocols:
- **Framing**: Almost all link\-layer protocols encapsulate the network\-layer datagram within a link\-layer frame before transmission\. This frame consists of a data field \(holding the datagram\) and various header fields defined by the protocol\. Different link\-layer protocols have different frame formats\.
- **Link Access**: For **point\-to\-point links** \(with a single sender and receiver\)\, link access is straightforward; the sender can transmit whenever the link is idle\. However\, for **broadcast links** \(shared by multiple nodes\)\, a **Medium Access Control \(MAC\) protocol** is essential to coordinate frame transmissions\. This is known as the **multiple access problem**\.
- **Error Detection and Correction**: The link layer often provides mechanisms to detect and sometimes correct bit errors that can occur due to signal attenuation and noise during transmission\. The transmitting node adds error\-detection/correction bits to the frame\, and the receiver performs a check\. While the transport and network layers also offer some error detection \(like the Internet checksum\)\, link\-layer error detection is typically more sophisticated and implemented in hardware\.

**3\. Implementation of the Link Layer:**

The link layer is typically implemented as a combination of hardware and software on a **network adapter** or **Network Interface Controller \(NIC\)**\. Much of the link\-layer functionality\, such as framing\, link access\, and error detection\, is implemented in hardware on the NIC\. Software components running on the host's CPU handle higher\-level tasks like assembling addressing information\, activating the hardware\, responding to interrupts upon frame reception\, handling errors\, and passing the datagram up to the network layer\. The link layer serves as the interface between the software of the protocol stack and the underlying network hardware\.

**4\. Error Detection and Correction Techniques \(Detailed\):**

Chapter 6 discusses several fundamental error detection techniques:
- **Parity Checks**: The simplest form involves adding a parity bit to the data to make the total number of 1s \(or 0s\) even or odd\. A two\-dimensional parity scheme can detect and correct single bit errors\.
- **Checksumming Methods**: More robust than simple parity\, checksumming involves summing the data in blocks and including the sum in the transmitted data\. The receiver performs the same calculation and checks if the sums match\. The Internet checksum is used at both the transport \(UDP and TCP\) and network \(IP\) layers\.
- **Cyclic Redundancy Check \(CRC\)**: CRC is a widely used and powerful error detection technique that treats the data as a binary number and divides it by a generator polynomial\. The remainder of this division is included in the frame as the CRC\. CRC can detect a wide range of error patterns\.

More sophisticated techniques offer error correction\, where the receiver can identify and fix the corrupted bits\. However\, more robust error detection and correction generally come with increased overhead in terms of computation and the number of added bits\.

**5\. Multiple Access Links and Protocols \(Detailed\):**

When multiple nodes share a broadcast channel\, they need protocols to regulate their transmissions to avoid collisions\. Chapter 6 outlines several categories of **multiple access protocols**:
- **Channel Partitioning Protocols**: These protocols divide the channel into smaller pieces \(in time\, frequency\, or code\) and allocate a piece to each node for exclusive use\.
    - **Time Division Multiplexing \(TDM\)**: Time is divided into slots\, and each node gets a slot to transmit\.
    - **Frequency Division Multiplexing \(FDM\)**: The frequency spectrum is divided into bands\, and each node gets a frequency band\.
    - **Code Division Multiple Access \(CDMA\)**: Each node is assigned a unique code\, allowing multiple nodes to transmit simultaneously; the receiver can decode the intended signal using the sender's code\. CDMA is prevalent in wireless networks\.
- **Random Access Protocols**: In these protocols\, a node transmits when it has data to send\. Collisions can occur if multiple nodes transmit at the same time\, and procedures are in place to handle these collisions\.
    - **ALOHA**: Nodes transmit whenever they have data\. If a collision occurs\, the senders retransmit after a random delay\. Slotted ALOHA improves efficiency by dividing time into slots and requiring transmissions to begin only at the start of a slot\.
    - **Carrier Sense Multiple Access \(CSMA\)**: Nodes listen to the channel before transmitting and only transmit if the channel is idle\.
    - **CSMA with Collision Detection \(CSMA/CD\)**: If a collision occurs during transmission\, the transmitting nodes stop and send a jam signal before retransmitting after a random backoff period\. CSMA/CD is used in wired Ethernet\.
- **Taking\-Turns Protocols**: These protocols ensure that only one node transmits at a time\, avoiding collisions\.
    - **Polling**: A master node polls each node in turn\, allowing it to transmit if it has data\.
    - **Token Passing**: A special token is passed among the nodes; a node can only transmit when it holds the token\.

The chapter also discusses **DOCSIS \(Data Over Cable Service Interface Specification\)**\, which is the link\-layer protocol for cable internet access and employs various multiple access methods for the upstream channel from cable modems to the Cable Modem Termination System \(CMTS\)\.

**6\. Switched Local Area Networks \(Detailed\):**

Modern LANs often utilize switches instead of shared broadcast media like hubs or buses\. Switches create a switched Ethernet environment that offers significant advantages\.
- **Link\-Layer Addressing \(MAC Addresses\) and ARP \(Detailed\):** Hosts and routers have network\-layer \(IP\) addresses and also link\-layer \(MAC\) addresses associated with their network interfaces \(adapters\)\. MAC addresses are typically 6 bytes long and intended to be unique for each adapter\. Link\-layer switches\, however\, do not have MAC addresses associated with their interfaces that connect to hosts and routers; they operate transparently\. MAC addresses are used for local communication within a LAN segment\. The **Address Resolution Protocol \(ARP\)** is crucial for translating IP addresses to the corresponding MAC addresses within the same subnet\. Each host and router maintains an **ARP table** \(cache\) that stores IP\-to\-MAC address mappings with a time\-to\-live \(TTL\) value\. When a host needs to send a datagram to another host on the same subnet but doesn't know its MAC address\, it sends an **ARP query** message \(broadcast within a link\-layer frame\) containing the target IP address\. The host with that IP address responds with an **ARP reply** message \(unicast within a standard frame\) containing its MAC address\. ARP is a "plug\-and\-play" protocol\, automatically building and maintaining the ARP table\. When sending to a host on a different subnet\, ARP is used to find the MAC address of the first\-hop router\. The existence of both IP and MAC addresses allows for the independence of network and link layers\, supporting various network\-layer protocols over the same LAN infrastructure\.
- **Ethernet \(Detailed\):** Ethernet is the dominant wired LAN technology\. Modern Ethernet typically uses a star topology with switches at the center\. Unlike older shared\-medium Ethernets that were susceptible to collisions\, **switched Ethernet** is collision\-free because switches buffer frames and forward them selectively\. The Ethernet frame has a preamble\, destination and source MAC addresses\, a type field \(indicating the upper\-layer protocol\)\, the data payload\, and a CRC for error detection\. Although Ethernet provides error detection\, it does not guarantee reliable delivery at the link layer; higher layers like TCP handle reliability\.
- **Link\-Layer Switches \(Detailed\):** Switches are store\-and\-forward packet switches that forward frames based on destination MAC addresses\. Switches maintain a **switch table** that maps MAC addresses to the switch interfaces on which those addresses have been observed\. When a frame arrives\, the switch examines the source MAC address and the interface it arrived on to learn the location of the sender\, updating its table\. For the destination MAC address\, the switch forwards the frame only to the interface\(s\) associated with that address in its table\. If the destination MAC address is unknown\, the switch floods the frame to all interfaces except the incoming one\. Switches are "plug\-and\-play" devices\, requiring no manual configuration of their forwarding tables\. They operate at layer 2 of the OSI model\.
- **Virtual Local Area Networks \(VLANs\) \(Detailed\):** VLANs allow for the logical grouping of devices within a LAN\, even if they are physically connected to different switches or different parts of the same switch\. VLANs provide traffic isolation between groups\. **Port\-based VLANs** are common\, where switch ports are assigned to specific VLANs\. Traffic within a VLAN is isolated from other VLANs\. To carry traffic belonging to multiple VLANs across a trunk link between switches\, frames are often **tagged** with VLAN identifiers \(e\.g\.\, using 802\.1Q tagging\)\. VLANs can also be based on MAC addresses or network\-layer protocols\. They are used to enhance security\, organize networks\, and improve efficiency by limiting broadcast domains\.

**7\. Link Virtualization: A Network as a Link Layer \(Detailed\):**

The concept of a "link" can be extended beyond a simple physical wire\. Technologies like **Multiprotocol Label Switching \(MPLS\)** allow an IP network to be treated as a link layer by interconnecting IP devices\. MPLS operates by adding a label to IP packets\. MPLS\-capable routers \(label\-switched routers\) forward packets based on these labels\, without needing to examine the IP header for routing decisions\, speeding up forwarding\. MPLS can create virtual circuits within an IP network\, offering traffic engineering and other capabilities\.

**8\. Data Center Networks:**

Chapter 6 also touches on the link\-layer aspects of data center networks\, which are critical for supporting cloud computing and large\-scale internet services\. Data centers often employ hierarchical\, tiered network topologies with access routers\, aggregation layer switches\, and core routers to interconnect a massive number of hosts \(servers\) organized in racks\. These networks need to handle high volumes of traffic\, both between external clients and internal hosts\, and between internal hosts\. Redundancy in network equipment and links is crucial for high availability\. VLANs are also used within data centers to partition subnets and localize broadcast traffic\.

**9\. Retrospective: A Day in the Life of a Web Page Request:**

By the end of Chapter 6\, having covered the link\, network\, and transport layers\, the book provides a holistic view of how a simple web page request involves numerous protocols at each layer\, working together to deliver the content to the user\. This example reinforces the importance of the link layer in providing the fundamental connectivity over the local Ethernet network to reach the first\-hop router and begin the journey across the Internet\.

In summary\, Chapter 6 is fundamental for understanding how data moves locally within a network segment\. It covers the essential services of the link layer\, including framing\, link access control\, and error detection\. It provides a detailed explanation of MAC addressing\, ARP\, Ethernet technology\, link\-layer switches\, and VLANs\, which are the building blocks of modern LANs\. Finally\, it introduces the concept of link virtualization and the role of the link layer in larger network environments like data centers\, setting the stage for understanding wireless and mobile networks discussed in subsequent chapters\.

## LAN Switch Operation: MAC Address Learning and Forwarding

When two computers in the same Local Area Network \(LAN\) send packets to each other via a switch\, the switch facilitates this communication by learning the MAC addresses of the connected devices and forwarding frames based on the destination MAC address present in the frame's header\. The switch itself does not need to have a unique MAC address configured on each of its ports for this fundamental forwarding operation\. Instead\, it operates transparently\, learning the locations of devices based on the source MAC addresses it observes\.

Here's a detailed explanation of the process:
1. **MAC Addresses of End Devices:** Each network interface card \(NIC\) in a computer \(or any other network device like a printer\) is assigned a unique 48\-bit MAC address\. This address serves as the link\-layer identifier for that specific interface\. A host or router with multiple network interfaces will have multiple MAC addresses\, one for each interface\.
1. **Frame Encapsulation:** When a sending computer \(let's call it Host A\) wants to send data to another computer \(Host B\) on the same LAN\, the application data is passed down through the protocol stack\. At the network layer \(e\.g\.\, using IP\)\, a packet is formed with the destination IP address of Host B and the source IP address of Host A\. This network\-layer packet is then passed down to the link layer\.
1. **Link\-Layer Addressing and Frame Creation:** At the link layer \(e\.g\.\, Ethernet in many LANs\)\, the network\-layer packet is encapsulated within a link\-layer frame\. The header of this frame contains several fields\, including the destination MAC address and the source MAC address\.
    - **Destination MAC Address:** This field should contain the MAC address of Host B's network interface\. If Host A already knows Host B's MAC address \(perhaps from a previous communication or from its ARP cache\)\, it will use that address\. If Host A does not know Host B's MAC address \(but knows its IP address\)\, it will initiate an Address Resolution Protocol \(ARP\) process\.
        - **ARP Process:** Host A sends an ARP query packet containing Host B's IP address as the target IP address\. This ARP query is encapsulated in a link\-layer frame with the destination MAC address set to the broadcast MAC address \(FF\-FF\-FF\-FF\-FF\-FF\)\. The source MAC address of this frame is Host A's MAC address\.
        - When the switch receives this broadcast frame\, it forwards it out of all its ports \(except the one it arrived on\) because the destination MAC address is a broadcast address or because it might not yet know the destination\.
        - Host B \(and all other devices on the LAN\) receives the ARP request\. Host B recognizes its IP address in the ARP query and sends back an ARP reply\. This ARP reply packet contains Host B's MAC address and its IP address\. The ARP reply is encapsulated in a link\-layer frame with the destination MAC address set to Host A's MAC address and the source MAC address set to Host B's MAC address\.
        - When the switch receives the ARP reply\, it learns \(or refreshes its knowledge of\) Host B's MAC address and the port it's connected to by examining the source MAC address of the incoming frame\. It then forwards the ARP reply frame only to the port connected to Host A\, based on the destination MAC address in the frame\.
        - Host A receives the ARP reply and stores the mapping of Host B's IP address to its MAC address in its ARP cache\.
    - **Source MAC Address:** This field contains the MAC address of Host A's network interface\.
1. **Frame Transmission and Switch Learning:** Once Host A has Host B's MAC address\, it creates a data frame with the destination MAC address of Host B and its own MAC address as the source MAC address\. This frame contains the IP packet destined for Host B in its data field\. Host A then transmits this frame into the LAN\, which is connected to one of the switch's ports\.
1. **Switch Operation: Forwarding and Filtering:** When the switch receives the frame from Host A\, it performs the following actions:
    - **Learning:** The switch examines the source MAC address \(Host A's MAC address\) of the incoming frame and records this MAC address along with the port number on which the frame was received in its switch table\. This allows the switch to learn the physical location \(in terms of its ports\) of Host A\. If an entry for Host A's MAC address already exists in the table\, the switch may update the timestamp associated with that entry\.
    - **Forwarding:** The switch then examines the destination MAC address \(Host B's MAC address\) in the frame\.
        - **Destination MAC Address Found in Table:** If the switch has an entry in its switch table for Host B's MAC address\, it knows the port to which Host B \(or the network segment containing Host B\) is connected\. The switch will then forward the frame only to that specific output port\. This is called filtering\, as the frame is prevented from being sent to other ports where Host B is not located\.
        - **Destination MAC Address Not Found in Table:** If the switch does not have an entry in its table for Host B's MAC address\, it doesn't know where Host B is located\. In this case\, the switch will forward the frame out of all its ports except the port on which it received the frame\. This is known as broadcasting\. Host B will receive the frame\, and if the destination MAC address matches its own\, it will process the frame\. Once Host B replies to Host A\, the switch will learn Host B's MAC address and its corresponding port\. Subsequent frames destined for Host B will then be forwarded directly to the correct port\.
        - **Destination MAC Address is Broadcast:** If the destination MAC address in the frame is the broadcast address \(FF\-FF\-FF\-FF\-FF\-FF\)\, the switch will forward the frame out of all ports except the incoming port\. This is how ARP requests and other broadcast messages reach all devices on the LAN\.
        - **Destination MAC Address is Multicast:** Switches typically also handle multicast MAC addresses by forwarding frames to the ports that have registered interest in that multicast group\.
1. **Frame Reception by Destination:** When the frame reaches the port connected to Host B\, Host B's NIC checks if the destination MAC address in the frame matches its own MAC address\. If it does\, the NIC passes the data \(the encapsulated IP packet\) up to the network layer for further processing\. If the MAC addresses do not match \(and it's not a broadcast or multicast frame that the host should process\)\, the NIC will discard the frame\.

**Why the Switch Doesn't Need Its Own MAC Address Per Port for Basic Forwarding:**

The switch's primary role in this scenario is to act as an intelligent intermediary that learns the association between MAC addresses and its ports and then uses the destination MAC address in incoming frames to make forwarding decisions\. The communication is directly between the MAC addresses of the source and destination computers\. The switch observes this traffic\, learns from the source MAC addresses\, and directs traffic based on the destination MAC addresses\.

The switch itself does have a MAC address \(or multiple if it has VLAN interfaces or management interfaces\)\. However\, this MAC address is typically used for management purposes \(e\.g\.\, accessing the switch's configuration interface\) or in protocols that involve the switch directly \(e\.g\.\, Spanning Tree Protocol\, VLAN tagging with 802\.1Q\)\. For the basic function of forwarding frames between devices connected to its ports within the same LAN\, the switch operates based on the MAC addresses of those end devices and the destination MAC address in the Ethernet frames\, without requiring a unique MAC address to be the source or destination of the user data traffic at each port\. The switch is "transparent" in that the end hosts are communicating at the link layer as if they were directly connected\, even though the switch is in between\.

In summary\, the switch functions as a layer\-2 \(link\-layer\) device that forwards frames based on MAC addresses\. It learns the location of devices by observing the source MAC addresses of incoming frames and uses the destination MAC address to determine the appropriate output port\(s\) for forwarding\. This process enables communication between computers on the same LAN without the switch needing to inject its own MAC address into the data path for each connection\.